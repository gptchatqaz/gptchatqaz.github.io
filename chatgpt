import { useState, useEffect } from "react";

export default function ZloyRoyLanding() {
  const [showForm, setShowForm] = useState(false);
  const [formData, setFormData] = useState({ name: "", phone: "" });
  const [timer, setTimer] = useState(2400); // 5 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

  useEffect(() => {
    const countdown = setInterval(() => {
      setTimer((prev) => (prev > 0 ? prev - 1 : 0));
    }, 1000);

    return () => clearInterval(countdown);
  }, []);

  const formatTime = (seconds) => {
    const m = String(Math.floor(seconds / 60)).padStart(2, '0');
    const s = String(seconds % 60).padStart(2, '0');
    return `00:${m}:${s}`;
  };

  const handleFormSubmit = (e) => {
    e.preventDefault();

    const telegramToken = "7891812472:AAFgGoCFmLqfdAgsE3qFZNEtnLeOSXTm0wc";
    const chatId = "654680309";
    const message = `–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞:\n–ò–º—è: ${formData.name}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${formData.phone}`;

    fetch(`https://api.telegram.org/bot${telegramToken}/sendMessage`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        chat_id: chatId,
        text: message,
      }),
    })
      .then(() => {
        alert("–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.");
        setFormData({ name: "", phone: "" });
        setShowForm(false);
      })
      .catch((error) => {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ Telegram:", error);
        alert("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ –ø–æ–∑–∂–µ.");
      });
  };

  return (
    <div className="bg-yellow-50 min-h-screen text-brown-800">
      {/* Hero Section */}
      <section className="py-16 px-4 text-center bg-[url('/honey-bg.jpg')] bg-cover bg-center">
        <h1 className="text-4xl md:text-5xl font-bold mb-4">–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –ø—á–µ–ª–æ–≤–æ–¥—Å—Ç–≤–∞ –æ—Ç "–ó–ª–æ–≥–æ –†–æ—è"</h1>
        <p className="text-lg md:text-xl mb-6">–ú—ë–¥, –ø–µ—Ä–≥–∞, –ø—Ä–æ–ø–æ–ª–∏—Å –∏ –¥—Ä—É–≥–∏–µ –¥–∞—Ä—ã —É–ª—å—è ‚Äî —Å –∑–∞–±–æ—Ç–æ–π –æ –≤–∞—à–µ–º –∑–¥–æ—Ä–æ–≤—å–µ</p>
        <button onClick={() => setShowForm(true)} className="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-6 rounded-2xl shadow-lg transition-all">–ó–∞–∫–∞–∑–∞—Ç—å —Å–µ–π—á–∞—Å</button>
      </section>

      {/* Timer Section */}
      <section className="bg-red-100 py-8 text-center">
        <h2 className="text-2xl font-bold mb-2 text-red-700">üî• –£—Å–ø–µ–π—Ç–µ –∑–∞–∫–∞–∑–∞—Ç—å –ø–æ –∞–∫—Ü–∏–∏!</h2>
        <p className="mb-4">–î–æ –∫–æ–Ω—Ü–∞ —Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∏ –æ—Å—Ç–∞–ª–æ—Å—å:</p>
        <div className="text-3xl font-mono text-red-800">{formatTime(timer)}</div>
      </section>

      {/* Reviews */}
      <section className="bg-white py-12 px-6">
        <h2 className="text-3xl font-semibold mb-6 text-center">–û—Ç–∑—ã–≤—ã –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
        <div className="grid md:grid-cols-3 gap-6">
          {[
            {
              name: "–ê–Ω–Ω–∞, 34 –≥–æ–¥–∞",
              text: "–ë–µ—Ä—É –º—ë–¥ —Ç–æ–ª—å–∫–æ —É –≤–∞—Å ‚Äî –≤–∫—É—Å –¥–µ—Ç—Å—Ç–≤–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ —Å–µ–º—å–∏!",
              img: "/review1.jpg"
            },
            {
              name: "–ú–∞—Ä–∏–Ω–∞, 42 –≥–æ–¥–∞",
              text: "–ü–µ—Ä–≥–∞ ‚Äî —Å—É–ø–µ—Ä –ø—Ä–æ–¥—É–∫—Ç, –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–∏–ª–∏–≤ —Å–∏–ª!",
              img: "/review2.jpg"
            },
            {
              name: "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞, 38 –ª–µ—Ç",
              text: "–ü—Ä–æ–ø–æ–ª–∏—Å –æ—Ç–ª–∏—á–Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ –ø—Ä–æ—Å—Ç—É–¥–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ!",
              img: "/review3.jpg"
            }
          ].map((review, i) => (
            <div key={i} className="bg-yellow-50 rounded-2xl p-6 shadow text-center">
              <img src={review.img} alt={review.name} className="w-20 h-20 rounded-full mx-auto mb-4 object-cover" />
              <p className="italic mb-2">"{review.text}"</p>
              <p className="font-semibold">‚Äî {review.name}</p>
            </div>
          ))}
        </div>
      </section>

      {/* CTA */}
      <section className="bg-yellow-100 py-12 px-6 text-center">
        <h2 className="text-2xl font-semibold mb-4">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–¥—É–∫—Ü–∏—é "–ó–ª–æ–≥–æ –†–æ—è" ‚Äî –∏ –ø–æ—á—É–≤—Å—Ç–≤—É–π—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É!</h2>
        <button onClick={() => setShowForm(true)} className="bg-yellow-600 hover:bg-yellow-700 text-white py-3 px-6 rounded-xl shadow-lg">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
      </section>

      {/* Map Section */}
      <section className="py-12 px-6">
        <h2 className="text-3xl font-semibold mb-6 text-center">–ù–∞—à –º–∞–≥–∞–∑–∏–Ω</h2>
        <div className="relative w-full h-80">
          <iframe 
            src="https://yandex.ru/map-widget/v1/?um=constructor%3A7e47eaff42b68568a358fc4e2160b8705d564bb015cf29cc9b066a3129a6e83a&source=constructor" 
            width="100%" 
            height="100%" 
            frameBorder="0" 
            allowFullScreen={true}>
          </iframe>
        </div>
        <p className="text-center mt-4">–ì–æ—Ä–æ–¥ –ú–∏–Ω—Å–∫, –£–ª–∏—Ü–∞ –Ø–∫—É–±–æ–≤—Å–∫–æ–≥–æ 36</p>
      </section>

      {/* Form Modal */}
      {showForm && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <form onSubmit={handleFormSubmit} className="bg-white p-8 rounded-2xl shadow-lg max-w-md w-full">
            <h3 className="text-xl font-bold mb-4">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</h3>
            <input
              type="text"
              placeholder="–í–∞—à–µ –∏–º—è"
              value={formData.name}
              onChange={(e) => setFormData({ ...formData, name: e.target.value })}
              className="w-full border p-2 mb-4 rounded-xl"
              required
            />
            <input
              type="tel"
              placeholder="–¢–µ–ª–µ—Ñ–æ–Ω"
              value={formData.phone}
              onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
              className="w-full border p-2 mb-4 rounded-xl"
              required
            />
            <button type="submit" className="bg-yellow-600 hover:bg-yellow-700 text-white w-full py-2 rounded-xl">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            <button type="button" onClick={() => setShowForm(false)} className="mt-4 text-sm underline text-gray-500">–û—Ç–º–µ–Ω–∞</button>
          </form>
        </div>
      )}

      {/* Footer */}
      <footer className="py-8 px-6 text-center text-sm text-gray-600">
        <div className="mb-2">–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏: <a href="tel:+375291234567" className="text-blue-600 underline">+375 (29) 123-45-67</a></div>
        ¬© 2025 –ó–ª–æ–π –†–æ–π. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã. | <a href="#" className="underline">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
      </footer>
    </div>
  );
}
